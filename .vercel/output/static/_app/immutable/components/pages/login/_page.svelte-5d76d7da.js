import{S as Q,i as X,s as Z,k as c,q as C,a as U,l as f,m as y,r as $,h as _,c as D,n as o,b as ee,C as l,I as j,J as q,L as oe,B as W,K as ue,M as he,D as ce,t as Y,d as _e,f as z,g as be,w as fe,x as de,y as pe,z as me}from"../../../chunks/index-c2872cc9.js";import{a as R}from"../../../chunks/store-38e9ee59.js";import{c as ve,P as ge}from"../../../chunks/public-f65b3fc4.js";const ye="https://lxdsjebbaxliighjcbxn.supabase.co",we=ge,A=ve(ye,we);function Ee(n){let e,t,r,a,m,s,h,d,p,u,N,I,i,w,b,P;return{c(){e=c("form"),t=c("div"),r=c("h1"),a=C("Supabase login"),m=U(),s=c("p"),h=C("Sign in via magic link with your email below"),d=U(),p=c("div"),u=c("input"),N=U(),I=c("div"),i=c("input"),this.h()},l(E){e=f(E,"FORM",{class:!0});var L=y(e);t=f(L,"DIV",{class:!0});var g=y(t);r=f(g,"H1",{class:!0});var O=y(r);a=$(O,"Supabase login"),O.forEach(_),m=D(g),s=f(g,"P",{class:!0});var T=y(s);h=$(T,"Sign in via magic link with your email below"),T.forEach(_),d=D(g),p=f(g,"DIV",{});var S=y(p);u=f(S,"INPUT",{class:!0,type:!0,placeholder:!0}),S.forEach(_),N=D(g),I=f(g,"DIV",{class:!0});var B=y(I);i=f(B,"INPUT",{type:!0,class:!0}),B.forEach(_),g.forEach(_),L.forEach(_),this.h()},h(){o(r,"class","text-3xl my-2 text-center"),o(s,"class",""),o(u,"class","my-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"),o(u,"type","email"),o(u,"placeholder","Your email"),o(i,"type","submit"),o(i,"class","inline-flex justify-center rounded-md border border-transparent bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:bg-indigo-600/50 disabled:hover:cursor-not-allowed"),i.value=w=n[0]?"Loading":"Send magic link",i.disabled=n[0],o(I,"class","flex justify-center"),o(t,"class","col-6 form-widget"),o(e,"class","row flex-center flex")},m(E,L){ee(E,e,L),l(e,t),l(t,r),l(r,a),l(t,m),l(t,s),l(s,h),l(t,d),l(t,p),l(p,u),j(u,n[1]),l(t,N),l(t,I),l(I,i),b||(P=[q(u,"input",n[3]),q(e,"submit",oe(n[2]))],b=!0)},p(E,[L]){L&2&&u.value!==E[1]&&j(u,E[1]),L&1&&w!==(w=E[0]?"Loading":"Send magic link")&&(i.value=w),L&1&&(i.disabled=E[0])},i:W,o:W,d(E){E&&_(e),b=!1,ue(P)}}}function ke(n,e,t){let r=!1,a;const m=async()=>{try{t(0,r=!0);const{error:h}=await A.auth.signIn({email:a});if(h)throw h;alert("Check your email for the login link!")}catch(h){alert(h.error_description||h.message)}finally{t(0,r=!1)}};function s(){a=this.value,t(1,a)}return[r,a,m,s]}class Ie extends Q{constructor(e){super(),X(this,e,ke,Ee,Z,{})}}function Pe(n){let e,t,r,a,m,s,h,d,p,u,N,I,i,w,b,P,E,L,g,O,T,S,B,H,x,V,J,G,te;return{c(){e=c("form"),t=c("div"),r=c("label"),a=C("Email"),m=U(),s=c("input"),d=U(),p=c("div"),u=c("label"),N=C("Name"),I=U(),i=c("input"),w=U(),b=c("div"),P=c("label"),E=C("Website"),L=U(),g=c("input"),O=U(),T=c("div"),S=c("input"),H=U(),x=c("div"),V=c("button"),J=C("Sign Out"),this.h()},l(k){e=f(k,"FORM",{class:!0});var v=y(e);t=f(v,"DIV",{});var K=y(t);r=f(K,"LABEL",{for:!0});var re=y(r);a=$(re,"Email"),re.forEach(_),m=D(K),s=f(K,"INPUT",{id:!0,type:!0}),K.forEach(_),d=D(v),p=f(v,"DIV",{});var M=y(p);u=f(M,"LABEL",{for:!0});var le=y(u);N=$(le,"Name"),le.forEach(_),I=D(M),i=f(M,"INPUT",{id:!0,type:!0}),M.forEach(_),w=D(v),b=f(v,"DIV",{});var F=y(b);P=f(F,"LABEL",{for:!0});var ae=y(P);E=$(ae,"Website"),ae.forEach(_),L=D(F),g=f(F,"INPUT",{id:!0,type:!0}),F.forEach(_),O=D(v),T=f(v,"DIV",{});var se=y(T);S=f(se,"INPUT",{type:!0,class:!0}),se.forEach(_),H=D(v),x=f(v,"DIV",{});var ne=y(x);V=f(ne,"BUTTON",{class:!0});var ie=y(V);J=$(ie,"Sign Out"),ie.forEach(_),ne.forEach(_),v.forEach(_),this.h()},h(){o(r,"for","email"),o(s,"id","email"),o(s,"type","text"),s.value=h=n[3].email,s.disabled=!0,o(u,"for","username"),o(i,"id","username"),o(i,"type","text"),o(P,"for","website"),o(g,"id","website"),o(g,"type","website"),o(S,"type","submit"),o(S,"class","button block primary"),S.value=B=n[0]?"Loadin...":"Update",S.disabled=n[0],o(V,"class","button block"),V.disabled=n[0],o(e,"class","form-widget")},m(k,v){ee(k,e,v),l(e,t),l(t,r),l(r,a),l(t,m),l(t,s),l(e,d),l(e,p),l(p,u),l(u,N),l(p,I),l(p,i),j(i,n[1]),l(e,w),l(e,b),l(b,P),l(P,E),l(b,L),l(b,g),j(g,n[2]),l(e,O),l(e,T),l(T,S),l(e,H),l(e,x),l(x,V),l(V,J),G||(te=[q(i,"input",n[7]),q(g,"input",n[8]),q(V,"click",n[6]),he(n[4].call(null,e)),q(e,"submit",oe(n[5]))],G=!0)},p(k,[v]){v&8&&h!==(h=k[3].email)&&s.value!==h&&(s.value=h),v&2&&i.value!==k[1]&&j(i,k[1]),v&4&&j(g,k[2]),v&1&&B!==(B=k[0]?"Loadin...":"Update")&&(S.value=B),v&1&&(S.disabled=k[0]),v&1&&(V.disabled=k[0])},i:W,o:W,d(k){k&&_(e),G=!1,ue(te)}}}function Le(n,e,t){let r;ce(n,R,i=>t(3,r=i));let a=!0,m=null,s=null,h=null;function d(i){try{t(0,a=!0);const w=A.auth.user();A.from("profiles").select("username, website, avatar_url").eq("id",w==null?void 0:w.id).single().then(({data:b,error:P,status:E})=>{if(b&&(t(1,m=b.username),t(2,s=b.website),h=b.avatar_url),P&&E!==406)throw P})}catch(w){alert(w.message)}finally{t(0,a=!1)}}async function p(){try{t(0,a=!0);const w={id:A.auth.user().id,username:m,website:s,avatar_url:h,updated_at:new Date};let{error:b}=await A.from("profiles").upsert(w,{returning:"minimal"});if(b)throw b}catch(i){alert(i.message)}finally{t(0,a=!1)}}async function u(){try{t(0,a=!0);let{error:i}=await A.auth.signOut();if(i)throw i}catch(i){alert(i.message)}finally{t(0,a=!1)}}function N(){m=this.value,t(1,m)}function I(){s=this.value,t(2,s)}return[a,m,s,r,d,p,u,N,I]}class Se extends Q{constructor(e){super(),X(this,e,Le,Pe,Z,{})}}function Ue(n){let e,t;return e=new Ie({}),{c(){fe(e.$$.fragment)},l(r){de(e.$$.fragment,r)},m(r,a){pe(e,r,a),t=!0},i(r){t||(z(e.$$.fragment,r),t=!0)},o(r){Y(e.$$.fragment,r),t=!1},d(r){me(e,r)}}}function De(n){let e,t;return e=new Se({}),{c(){fe(e.$$.fragment)},l(r){de(e.$$.fragment,r)},m(r,a){pe(e,r,a),t=!0},i(r){t||(z(e.$$.fragment,r),t=!0)},o(r){Y(e.$$.fragment,r),t=!1},d(r){me(e,r)}}}function Ne(n){let e,t,r,a;const m=[De,Ue],s=[];function h(d,p){return d[0]?0:1}return t=h(n),r=s[t]=m[t](n),{c(){e=c("div"),r.c(),this.h()},l(d){e=f(d,"DIV",{class:!0});var p=y(e);r.l(p),p.forEach(_),this.h()},h(){o(e,"class","flex justify-center")},m(d,p){ee(d,e,p),s[t].m(e,null),a=!0},p(d,[p]){let u=t;t=h(d),t!==u&&(be(),Y(s[u],1,1,()=>{s[u]=null}),_e(),r=s[t],r||(r=s[t]=m[t](d),r.c()),z(r,1),r.m(e,null))},i(d){a||(z(r),a=!0)},o(d){Y(r),a=!1},d(d){d&&_(e),s[t].d()}}}function Ve(n,e,t){let r;return ce(n,R,a=>t(0,r=a)),R.set(A.auth.user()!=null||A.auth.user()!=null),A.auth.onAuthStateChange((a,m)=>{R.set(m.user!=null||m.user!=null)}),[r]}class Oe extends Q{constructor(e){super(),X(this,e,Ve,Ne,Z,{})}}export{Oe as default};
